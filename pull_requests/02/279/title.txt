Codegen for ports and channels