Kernel refactor (part 1 of ??)