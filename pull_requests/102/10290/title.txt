Move implementation for threads to Rust