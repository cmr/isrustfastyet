Solve some nasty descheduling races with a lock