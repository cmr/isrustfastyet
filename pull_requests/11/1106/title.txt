Correct handling of non-numeric chars in parse_buf