Use a small amount of unsafe code to optimise vec.remove & .insert