Simplify and rename macro API