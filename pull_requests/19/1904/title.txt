big json rewrite, and other misc features