core: Allocate threads on demand, not on scheduler startup