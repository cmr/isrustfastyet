Adding stat support, and other misc cleanup