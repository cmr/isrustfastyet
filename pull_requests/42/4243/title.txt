Fix a bug in Result::unwrap_err (and minor cleanup)