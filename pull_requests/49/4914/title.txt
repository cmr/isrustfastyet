Adjust borrow checker algorithm to address #4856 unsoundness,