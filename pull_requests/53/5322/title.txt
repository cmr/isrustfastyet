Continue work on #4812