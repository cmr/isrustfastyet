libcore: handle trailing newlines more like other languages.