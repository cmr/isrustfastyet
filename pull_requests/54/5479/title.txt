Making str allocate less #2: trim and substr