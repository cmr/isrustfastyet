Restore Num trait and use macros to implement and test NumCast