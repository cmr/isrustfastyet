New I/O API, scheduler improvements