Refactor core::run in order to address many of the issues...