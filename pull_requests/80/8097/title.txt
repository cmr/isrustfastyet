Sha1 and Sha2 cleanups & optimizations