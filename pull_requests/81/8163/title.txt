librustc: Introduce a new visitor type based on traits