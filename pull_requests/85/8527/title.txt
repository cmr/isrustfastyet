Visitor trait rewrite, step 1.