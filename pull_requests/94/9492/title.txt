#7081 syntax::visit refactor remainder